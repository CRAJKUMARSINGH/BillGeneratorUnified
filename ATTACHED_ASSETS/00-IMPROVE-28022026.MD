# ✅ **MASTER PROMPT – FINAL (ALL-INCLUSIVE & SAFE)**

## **Primary Objective**

The **online data-entry module is a mission-critical core component** of the application and must **never be treated as optional**.

In real-world usage:

* Excel uploads are followed by **mandatory online edits**
* **Part-rate payments** (lower than work-order rates) are common
* Hybrid Excel + online workflows are essential

⚠️ **At no point should development, testing, or enhancement “बिगाड़” (break/destabilize) the application.**

---

## **1. Functional Requirements**

### **1.1 Online / Browser-Based Entry**

* Online mode must render data as an **Excel-like editable grid in the browser**
* Grid must support:

  * Inline editing
  * Real-time validation
  * Auto-calculation
  * Keyboard navigation (Tab, Enter, arrows)
  * Copy / paste (cells, rows, columns)
  * Undo / redo

---

### **1.2 Part-Rate Handling**

* Some items require **part-rate payment** lower than the work-order rate
* When a rate is reduced:

  * Display as: **₹95 (Part Rate)**
  * Original rate must remain internally preserved for audit
  * All calculations must use the **part rate**

---

### **1.3 Excel Upload + Online Hybrid Mode**

* Support:

  * Excel upload
  * Online editing
  * Re-download of Excel without data loss
* Switching modes must:

  * Preserve all edits
  * Maintain formatting
  * Never corrupt data

---

## **2. Excel + Browser Grid UX Specifications (MANDATORY)**

### **2.1 Visual & Layout**

* Excel-like appearance:

  * Fixed header row
  * Sticky first column (Item No / Description)
  * Column resizing
  * Row height adjustment
  * Clear active-cell focus
* Alignment:

  * Numbers → right aligned
  * Text → left aligned

---

### **2.2 Cell Behavior & Validation**

* Quantity:

  * Zero allowed
  * Decimal support where applicable
* Rate:

  * Editable only for part-rate items
  * Auto-append **(Part Rate)** on reduction
* Validation:

  * Invalid cells highlighted
  * Inline tooltip errors
  * Submission blocked until resolved

---

### **2.3 Calculation & Change Tracking**

* Real-time totals update
* Modified cells visually highlighted
* Change log must record:

  * Original value
  * Modified value
  * Reason (Part Rate / Manual Edit)

---

### **2.4 Performance & Accessibility**

* Must handle **1000+ rows** smoothly
* Full keyboard operation required
* ARIA roles for accessibility compliance

---

## **3. Test Execution Requirements**

### **3.1 Input File Testing**

* Use **multiple Excel input files**
* Process files **one by one**
* Repeat tests with **randomized file order**

---

### **3.2 Mandatory Per-Bill Modifications**

For **each bill**:

1. Select **three zero-quantity items** → change to non-zero
2. Select **2–3 items with quantity** → reduce rate by **₹5**
3. Append **(Part Rate)** automatically wherever rate is reduced

---

## **4. Iteration, Cache & Memory Robustness Testing**

* Run tests for **high-volume multiple iterations**
* Between iterations:

  * Clear browser cache
  * Reset session/local storage
  * Monitor memory usage
* Validate:

  * No stale data
  * No memory leaks
  * Stable long-session performance

---

## **5. Automation & Test Coverage**

Create a **comprehensive automated test suite** covering:

* Excel upload workflow
* Online grid editing
* Hybrid Excel + online workflow
* Part-rate logic
* Data persistence
* Cache cleanup
* Memory stability

---

## **6. Success Criteria**

* Tests must run for **sufficient iterations** to certify:

  * Functional correctness
  * UX stability
  * Cache & memory robustness
* Target: **101% success**

  * 100% compliance
  * +1 validation for the additional awarded feature

---

## **7. APPLICATION SAFETY – “DON’T बिगाड़ THE APP” (NON-NEGOTIABLE)**

### **7.1 Stability First Rule**

* No change may:

  * Break existing workflows
  * Degrade performance
  * Introduce regressions
  * Corrupt existing or uploaded data

---

### **7.2 Backward Compatibility (MANDATORY)**

* Existing Excel formats
* Existing bills
* Existing outputs

---

### **7.3 Controlled Change Policy**

* All enhancements must:

  * Use feature flags OR
  * Be deployed first in staging/test
* Production updates only after:

  * Full test pass
  * No regressions
  * Verified memory & cache stability

---

### **7.4 Rollback Protection**

* Every change must include:

  * Rollback plan
  * Version tagging
  * Test-linked commit messages
* On instability:

  * Immediate revert
  * Fix first, commit later

---

### **NON-NEGOTIABLE STATEMENT**

> **Do NOT “fix”, “optimize”, or “improve” anything if there is even a small risk of breaking the app.**
> Stability > Reliability > Features

---

## **8. Governance & Process Control**

> **Why was the Git repository updated without correcting the app first?**

This must be reviewed to enforce:

* Fix-before-commit discipline
* Test-validated commits only
* Accountability in releases

---

## **9. Final Deliverables**

* Excel + browser grid UX specification
* Automated test scripts
* Iteration & stress-test logs
* Cache & memory certification report
* Final robustness sign-off

---

### ✅ **FINAL ASSURANCE**

The goal is to **strengthen the app without damaging it**.
Anything that risks “बिगाड़ना” is **strictly prohibited**.

---

If you want next:

* One-page **Developer Mandate**
* **QA Test Case matrix**
* **Git commit & release policy**
* **Automation scripts (Playwright/Selenium)**

बस बोलिए।
